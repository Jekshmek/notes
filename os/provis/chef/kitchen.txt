Kitchen:
    UT suite
    http://kitchen.ci/
    http://kitchen.ci/docs/getting-started/creating-cookbook
    http://kitchen.ci/docs/getting-started/writing_test

    http://serverspec.org/
    http://serverspec.org/resource_types.html

    https://relishapp.com/rspec/rspec-core/docs

    kitchen
        list
            list a test-matrix
        create
            [INSTANCE|REGEXP|all]
                ? do a vagrant up --no-provision
        converge [-l debug]
            [INSTANCE|REGEXP|all]
                apply a recipe to a vm
        verify
            [INSTANCE|REGEXP|all]
        destroy
            [INSTANCE|REGEXP|all]
        test
            [INSTANCE|REGEXP|all]
                aggregate multiple of commands
            --destroy=never
                !!!
        login
            login to the running test kitchen
        diagnose
            show final .kitchen.yml with all the default values
            --all
                to show ALL

defaults:
    --driver=kitchen-vagrant
environments:
    https://docwhat.org/setting-environment-test-kitchen/

options
    -l debug
    --log-level ...
        set log level

config:
http://kitchen.ci/docs/getting-started/dynamic-configuration

merge process:
.kitchen.local.yml
.kitchen.yml
~/.kitchen/config.yml

export KITCHEN_GLOBAL_YAML=/path/to/your/global/config.yml
export KITCHEN_PROJECT_YAML=/path/to/your/project/.kitchen.yml
export KITCHEN_LOCAL_YAML=/path/to/your/local/.kitchen.local.yml

.kitchen.yml
https://docs.chef.io/config_yml_kitchen.html

---
driver:
  name: vagrant
  ssh:
    private_key_path: 'C:/Users/<user>/.vagrant.d/insecure_private_key'
    insert_key: false
    username: "vagrant"
    password: "vagrant"
  customize: 
    memory: 10240
provisioner:
  name: chef_solo
  require_chef_omnibus: 12.4.1
  environments_path: "../../environments"
  solo_rb:
    environment: "local-iharh"
  log_level: <#= ENV['CHEF_LOG_LEVEL'] || auto %>
  client_rb:
    node_name: analytics.local
platforms:
  - name: centos-7.1
    driver:
      name: vagrant
    driver_config:
      customize:
        server_name: 'kt-my-centos-name'
        # https://github.com/test-kitchen/test-kitchen/issues/465
suites:
  - name: linux
    run_list:
      - recipe[cb-template-service::default]
    attributes:
      chef_client:
        config:
          log_level: ":info"
      chef_zero:
        config:
          log_level: ":info"
    excludes:
      - windows2012r2min

plugins:
https://github.com/test-kitchen/kitchen-vagrant


cache:
/tmp/kitchen
    /nodes


logs:
metadata.rb:

require "kitchen/provisioner/chef_zero.rb"

def chef_client_args
    level = config[:log_level] # == :info ? :auto : config[:log_level]
    args = [
      "--config #{remote_path_join(config[:root_path], "client.rb")}",
      "--log_level #{level}",
      "--force-formatter",
      "--no-color"
    ]
    add_optional_chef_client_args!(args)

    args
end

win:
http://kitchen.ci/blog/test-kitchen-windows-test-flight-with-vagrant/
